---
import ThemeToggle from "../components/ThemeToggle.astro";

const navLinks = [
  {
    label: "Work",
    href: "/",
  },
  {
    label: "Resume",
    href: "/resume",
  },
  {
    label: "Contact",
    href: "mailto:kachun@kachunchau.com",
  },
];
---

<header
  class="mx-4 flex max-w-7xl flex-col items-stretch justify-between gap-4 rounded-xl border border-slate-200 bg-white px-6 py-4.5 md:mx-10 md:flex-row md:items-center md:px-10 md:py-4 lg:px-10 xl:mx-auto dark:border-white/10 dark:bg-transparent dark:backdrop-blur-lg"
  data-astro-transition-scope="header"
>
  <nav class="flex flex-1 items-center justify-between gap-2">
    <ul class="flex gap-3 md:gap-4 xl:gap-5">
      {
        navLinks.map((item) => (
          <li class="relative">
            <a
              class="inline-block text-lg font-medium whitespace-nowrap before:absolute before:inset-x-0 before:-bottom-[19px] before:left-0 before:block before:h-0.5 before:content-[''] md:text-xl md:before:-bottom-[23px]"
              href={item.href}
            >
              {item.label}
            </a>
          </li>
        ))
      }
    </ul>

    <div
      class="flex flex-initial items-center overflow-clip text-sm text-emerald-400 md:text-base"
    >
      <div
        class="relative flex flex-none items-center justify-center p-2.5 after:absolute after:bottom-full after:left-0 after:hidden after:w-max after:rounded-md after:bg-slate-950 after:px-2 after:py-1 after:text-xs after:text-cyan-50 after:content-[attr(data-tooltip)] hover:after:block"
        data-tooltip="Currently open to new opportunities"
      >
        <span class="size-2 rounded-full bg-emerald-400"></span>
      </div>

      <span class="hidden truncate md:block"
        >Currently open to new opportunities</span
      >
    </div>
  </nav>

  <ThemeToggle />
</header>

<script>
  const updateActiveState = () => {
    const currentPath = window.location.pathname;
    document.querySelectorAll("header a[href]").forEach((link) => {
      const href = link.getAttribute("href");
      const isActive = href === currentPath;

      if (isActive) {
        link.setAttribute("aria-current", "page");
      } else {
        link.removeAttribute("aria-current");
      }
      link.classList.toggle("before:bg-teal-400", isActive);
    });
  };

  // Initialize
  updateActiveState();

  // Handle navigation
  document.addEventListener("astro:page-load", updateActiveState);
</script>
